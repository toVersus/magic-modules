<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This page discusses provider versioning, handling of breaking changes, and rare exceptions within Terraform development."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Understand breaking changes"><meta property="og:description" content="This page discusses provider versioning, handling of breaking changes, and rare exceptions within Terraform development."><meta property="og:type" content="article"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/develop/breaking-changes/"><meta property="article:section" content="develop"><meta property="article:modified_time" content="2023-07-05T10:03:44-07:00"><title>Understand breaking changes | Magic Modules</title><link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png type=image/x-icon><link rel=stylesheet href=/magic-modules/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/magic-modules/flexsearch.min.js></script>
<script defer src=/magic-modules/en.search.min.14dacf19e9b12e56698fcdca8bca4e2d8c7b89a3cebe46c99a9c4ad251575336.js integrity="sha256-FNrPGemxLlZpj83Ki8pOLYx7iaPOvkbJmpxK0lFXUzY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><span>Get started</span><ul><li><a href=/magic-modules/get-started/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/get-started/how-magic-modules-works/>How Magic Modules works</a></li><li><a href=/magic-modules/get-started/run-provider-tests/>Run provider tests</a></li><li><a href=/magic-modules/get-started/use-built-provider/>Use built provider</a></li><li><a href=/magic-modules/get-started/contributing/>Contributing</a></li><li><a href=/magic-modules/get-started/provider-documentation/>Provider documentation</a></li></ul></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/breaking-changes/ class=active>Understand breaking changes</a></li><li><a href=/magic-modules/develop/resource/>Add or modify a resource</a></li><li><a href=/magic-modules/develop/add-mmv1-test/>Add an MMv1 test</a></li><li><a href=/magic-modules/develop/add-handwritten-test/>Add a handwritten test</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource-documentation/>Add datasource documentation</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li></ul></li><li><a href=/magic-modules/best-practices/>Best practices</a><ul></ul></li><li><span>Contribute</span><ul><li><a href=/magic-modules/contribute/release-notes/>Write release notes</a></li><li><a href=/magic-modules/contribute/review-pr/>Review a PR</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource.rb target=_blank rel=noopener>Resource YAML reference ↗</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/type.rb target=_blank rel=noopener>Field YAML reference ↗</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource/iam_policy.rb target=_blank rel=noopener>IAM policy YAML reference ↗</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Understand breaking changes</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#provider-versioning>Provider Versioning</a></li><li><a href=#customer-trust>Customer Trust</a></li><li><a href=#exceptions-to-breaking-changes>Exceptions to Breaking Changes</a></li><li><a href=#breaking-changes>Breaking Changes</a><ul><li><a href=#provider-configuration-level-breakages>Provider Configuration Level Breakages</a></li><li><a href=#resource-list-level-breakages>Resource List Level Breakages</a></li><li><a href=#resource-level-breakages>Resource Level Breakages</a></li><li><a href=#field-level-breakages>Field Level Breakages</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=breaking-changes-and-provider-development>Breaking Changes and Provider Development
<a class=anchor href=#breaking-changes-and-provider-development>#</a></h1><h2 id=provider-versioning>Provider Versioning
<a class=anchor href=#provider-versioning>#</a></h2><p>As a provider is developed, resources are added, old resources are updated, and bugs are fixed. These changes are <a href=https://github.com/hashicorp/terraform-provider-google/releases/tag/v4.32.0>bundled together as a release</a>.</p><p>Releases are numerically defined with a version number in the form of <code>MAJOR.MINOR.PATCH</code>. Here, &lsquo;Patch&rsquo; indicates bug fixes, &lsquo;Minor&rsquo; represents new features, and &lsquo;Major&rsquo; represents significant changes which would be breaking to the customer if committed. Once a release is published, the provider binary is copied to <a href=https://registry.terraform.io/browse/providers>Hashicorp&rsquo;s provider registry</a>.</p><h2 id=customer-trust>Customer Trust
<a class=anchor href=#customer-trust>#</a></h2><p>Terraform authors can write modular configurations, aptly named modules. These are shared within organizations and <a href=https://registry.terraform.io/browse/modules>online</a>. Terraform configurations can specify <a href=https://www.terraform.io/language/providers/requirements>provider requirements</a>, including a <a href=https://www.terraform.io/language/providers/requirements#version-constraints>version constraint field</a>.</p><p>The configuration will then <a href=https://www.terraform.io/language/expressions/version-constraints>tie these version constraints</a> to an approximate minor or exact full version. Maintaining trust and consistency on every <code>MINOR</code> or <code>MAJOR</code> version upgrade is critical.</p><p>If breaking changes are allowed within <code>MINOR</code> versions, trust in the provider will be eroded and module creators will not have confidence in provider stability. This diminished trust will eventually lead to customers investing or deploying less to GCP.</p><h2 id=exceptions-to-breaking-changes>Exceptions to Breaking Changes
<a class=anchor href=#exceptions-to-breaking-changes>#</a></h2><p>While we strive to minimize breaking changes, there are certain exceptions where they become unavoidable. Notably, breaking changes are permissible when existing functionality is demonstrably broken due to an API or provider-level issue. In such cases, the change does not impact users negatively, since there is no instance where the Terraform provider is currently using the affected field or resource correctly.</p><p>For example, consider a situation involving the Google provider where an API endpoint we depend on changes its behavior or is deprecated. If the current implementation in the Terraform provider cannot adapt to this change and is thus broken, a breaking change would be necessary to restore the functionality.</p><h2 id=breaking-changes>Breaking Changes
<a class=anchor href=#breaking-changes>#</a></h2><p>Having established that we want to avoid breaking changes, let&rsquo;s delve into what exactly constitutes a breaking change. We&rsquo;ll discuss this under four main categories and the rules within each.</p><h3 id=provider-configuration-level-breakages>Provider Configuration Level Breakages
<a class=anchor href=#provider-configuration-level-breakages>#</a></h3><ul><li>Top-level behavior such as provider configuration and authentication changes.</li></ul><h4 id=provider-config-fundamental>Changing fundamental provider behavior (Undetectable)</h4><p>Including, but not limited to, modification of: authentication, environment variable usage, and constricting retry behavior.</p><h3 id=resource-list-level-breakages>Resource List Level Breakages
<a class=anchor href=#resource-list-level-breakages>#</a></h3><ul><li>Resource/datasource naming conventions and entry differences.</li></ul><h4 id=resource-map-resource-removal-or-rename>Removing or Renaming a Resource</h4><p>In Terraform, resources should be retained whenever possible. Removal of a resource will result in a configuration breakage wherever a dependency on that resource exists. Renaming or removing resources are functionally equivalent in terms of configuration breakages.</p><h3 id=resource-level-breakages>Resource Level Breakages
<a class=anchor href=#resource-level-breakages>#</a></h3><ul><li>Individual resource breakages like field entry removals or behavior within a resource.</li></ul><h4 id=resource-schema-field-removal-or-rename>Removing or Renaming a field</h4><p>In Terraform, fields should be retained whenever possible. Removal of a field will result in a configuration breakage wherever a dependency on that field exists. Renaming or removing a field are functionally equivalent in terms of configuration breakages.</p><h4 id=resource-id>Changing resource ID format (Undetectable)</h4><p>Terraform uses resource ID to read resource state from the API. Modification of the ID format will break the ability to parse the IDs from any deployments.</p><h4 id=resource-import-format>Changing resource ID import format (Undetectable)</h4><p>Automation external to our provider may rely on importing resources with a certain format. Removal or modification of existing formats will break this automation.</p><h3 id=field-level-breakages>Field Level Breakages
<a class=anchor href=#field-level-breakages>#</a></h3><ul><li>Field-level conventions like attribute changes and naming conventions.</li></ul><h4 id=field-changing-type>Changing Field Type</h4><p>While certain Field Type migrations may be supported at a technical level, it&rsquo;s a practice that we highly discourage. We see little value for these transitions vs the risk they impose.</p><h4 id=field-optional-to-required>Field becoming Required Field</h4><p>A field should not become &lsquo;Required&rsquo; as existing configurations may not have this field defined, leading to broken configurations in sequential plans or applies.. If you are adding &lsquo;Required&rsquo; to a field so a block won&rsquo;t remain empty, this can cause two issues. First, if it&rsquo;s a singular nested field, the block may gain more fields later and it&rsquo;s not clear whether the field is actually required so it may be misinterpreted by future contributors. Second, if users are defining empty blocks in existing configurations, this change will break them. Consider these points in admittance of this type of change.</p><h4 id=field-becoming-computed>Becoming a Computed only Field</h4><p>While a field can transition from &lsquo;Optional&rsquo; to &lsquo;Optional+Computed&rsquo;, it should not change from &lsquo;Required&rsquo; or &lsquo;Optional&rsquo; to solely &lsquo;Computed&rsquo;. This transition would effectively make the field read-only, thus breaking configs in sequential plan or applies where this field is defined in a configuration.</p><h4 id=field-oc-to-c>Optional and Computed to Optional</h4><p>A field should not transition from &lsquo;Computed + Optional&rsquo; to &lsquo;Optional&rsquo;. During a sequential apply, the Terraform state retains the previously computed value, which won&rsquo;t match the configuration, thus causing a discrepancy.</p><h4 id=field-changing-default-value>Adding or Changing a Default Value</h4><p>Adding a default value where one was not previously declared can work in a very limited subset of scenarios but is an all around &rsquo;not good&rsquo; practice to engage in. Changing a default value will absolutely cause a breakage. The mechanism of break for both scenarios is current terraform deployments now gain a diff with sequential applies where the diff is the new or changed default value.</p><h4 id=field-growing-min>Growing Minimum Items</h4><p>&lsquo;MinItems&rsquo; cannot grow. Otherwise, existing terraform configurations that don&rsquo;t satisfy this rule will break.</p><h4 id=field-shrinking-max>Shrinking Maximum Items</h4><p>&lsquo;MaxItems&rsquo; cannot shrink. Otherwise, existing terraform configurations that don&rsquo;t satisfy this rule will break.</p><h4 id=field-changing-data-format>Changing field data format (Undetectable)</h4><p>Modification of the data format (either by the API or manually) will cause a diff in subsequent plans if that field is not Computed. This results in a breakage. API breaking changes are out of scope with respect to provider responsibility but we may make changes in response to API breakages in some instances to provide more customer stability.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/44080080b07dcf19314c24977f049ae1c9f0ec27 title='Last modified by Scott Suarez | July 5, 2023' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 5, 2023</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/develop%2fbreaking-changes.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/develop/breaking-changes.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#provider-versioning>Provider Versioning</a></li><li><a href=#customer-trust>Customer Trust</a></li><li><a href=#exceptions-to-breaking-changes>Exceptions to Breaking Changes</a></li><li><a href=#breaking-changes>Breaking Changes</a><ul><li><a href=#provider-configuration-level-breakages>Provider Configuration Level Breakages</a></li><li><a href=#resource-list-level-breakages>Resource List Level Breakages</a></li><li><a href=#resource-level-breakages>Resource Level Breakages</a></li><li><a href=#field-level-breakages>Field Level Breakages</a></li></ul></li></ul></nav></div></aside></main></body></html>